/* ======================== 컴팩트 팝업 스타일 (B옵션) ======================== */

/* MapLibre 팝업 컨테이너 - 다크모드 */
.maplibre-popup-custom.popup-dark .maplibregl-popup-content {
  padding: 0;
  background: #1f2937;
  border-radius: 8px;
  box-shadow: 0 4px 16px rgba(0,0,0,0.3);
  border: 1px solid rgba(255,255,255,0.1);
  overflow: hidden;
}

.maplibre-popup-custom.popup-dark .maplibregl-popup-tip {
  border-top-color: #1f2937;
}

/* MapLibre 팝업 컨테이너 - 라이트모드 */
.maplibre-popup-custom.popup-light .maplibregl-popup-content {
  padding: 0;
  background: #F5F0E8;
  border-radius: 8px;
  box-shadow: 0 4px 20px rgba(74, 93, 93, 0.15), 0 2px 6px rgba(0,0,0,0.08);
  border: 1px solid #d4cdc4;
  overflow: hidden;
}

.maplibre-popup-custom.popup-light .maplibregl-popup-tip {
  border-top-color: #F5F0E8;
}

/* Leaflet 팝업 컨테이너 - 다크모드 */
.leaflet-popup-custom.popup-dark .leaflet-popup-content-wrapper {
  padding: 0;
  background: #1f2937;
  border-radius: 8px;
  box-shadow: 0 4px 16px rgba(0,0,0,0.3);
  border: 1px solid rgba(255,255,255,0.1);
}

.leaflet-popup-custom.popup-dark .leaflet-popup-content {
  margin: 0;
  padding: 0;
  color: #f1f5f9;
}

.leaflet-popup-custom.popup-dark .leaflet-popup-tip {
  background: #1f2937;
  border: none;
  box-shadow: none;
}

/* Leaflet 팝업 컨테이너 - 라이트모드 */
.leaflet-popup-custom.popup-light .leaflet-popup-content-wrapper {
  padding: 0;
  background: #F5F0E8;
  border-radius: 8px;
  box-shadow: 0 4px 20px rgba(74, 93, 93, 0.15), 0 2px 6px rgba(0,0,0,0.08);
  border: 1px solid #d4cdc4;
}

.leaflet-popup-custom.popup-light .leaflet-popup-content {
  margin: 0;
  padding: 0;
  color: #1f2937;
}

.leaflet-popup-custom.popup-light .leaflet-popup-tip {
  background: #F5F0E8;
  border: none;
  box-shadow: none;
}

.leaflet-popup-custom .leaflet-popup-close-button {
  display: none;
}

/* Leaflet 팝업 tip 위치 조정 - 마커와 겹치지 않도록 */
.leaflet-popup-custom .leaflet-popup-tip-container {
  margin-top: -1px;
}

/* 팝업이 마우스 이벤트를 가로채지 않도록 - 마커 간 깜빡임 방지 */
.leaflet-popup-custom {
  pointer-events: none;
}

.leaflet-popup-custom .leaflet-popup-content-wrapper,
.leaflet-popup-custom .leaflet-popup-tip-container {
  pointer-events: none;
}

/* 팝업 내용 - 컴팩트 */
.popup-content {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
}

/* ======================== Leaflet 마커 호버 강조 스타일 ======================== */
/*
 * 핵심: Leaflet은 .leaflet-marker-icon에 transform: translate3d(...)로 위치를 지정함
 * 따라서 이 요소에 transform을 적용하면 위치가 (0,0)으로 초기화됨
 * 해결: 내부 .map-marker-shape 요소에만 scale을 적용
 */

/* Leaflet 아이콘 컨테이너 - transform 건드리지 않음, z-index만 조정 */
.leaflet-marker-icon.marker-hovered {
  z-index: 1000 !important;
  --marker-scale: 1.3;
  --marker-label-opacity: 1;
}

/* Leaflet 위치 애니메이션 비활성화 - 마커 이동 시 불필요한 transition 방지 */
.leaflet-marker-icon,
.leaflet-zoom-animated {
  transition: none !important;
}

/* 마커 공통 레이아웃 */
.map-marker-root.marker-hovered {
  --marker-scale: 1.3;
  --marker-label-opacity: 1;
}

.map-marker-ring {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  border: 2px solid transparent;
  border-radius: 9999px;
  box-shadow: 0 0 0 2px rgba(0,0,0,0.08);
  z-index: 0;
}

.map-marker-shape {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%) scale(var(--marker-scale, 1));
  transition: transform 0.12s ease-out, filter 0.12s ease-out;
  filter: drop-shadow(0 1px 3px rgba(0,0,0,0.25));
  z-index: 1;
}

.map-marker-shape path {
  vector-effect: non-scaling-stroke;
}

.leaflet-marker-icon.marker-hovered .map-marker-shape,
.map-marker-root.marker-hovered .map-marker-shape {
  filter: drop-shadow(0 2px 8px rgba(0,0,0,0.4));
}

.map-marker-label {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 9px;
  font-weight: 700;
  color: #ffffff;
  text-shadow: 0 1px 2px rgba(0,0,0,0.5);
  border-radius: 9999px;
  width: 14px;
  height: 14px;
  opacity: 1;
  transition: opacity 0.12s ease-out;
  pointer-events: none;
  z-index: 2;
}

.leaflet-marker-icon {
  overflow: visible;
}
